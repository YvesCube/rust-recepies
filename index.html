<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rust Crafting Master</title>
    <style>
        :root {
            --bg-color: #1b1b1b;
            --panel-color: #2b2b2b;
            --accent-color: #cd412b;
            --btn-color: #5f8a2d;
            --btn-hover: #76aa3b;
            --text-color: #cecece;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background-color: var(--panel-color);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            max-width: 600px;
            width: 100%;
            position: relative;
        }
        
        /* Language Flags */
        .lang-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 10px;
        }
        .flag-btn {
            background: #141414;
            border: 1px solid #444;
            border-radius: 4px;
            cursor: pointer;
            font-size: 20px;
            padding: 5px 10px;
            transition: 0.2s;
            filter: grayscale(100%);
        }
        .flag-btn:hover, .flag-btn.active {
            filter: grayscale(0%);
            border-color: var(--accent-color);
            background: #222;
        }

        h1 { color: var(--accent-color); text-align: center; margin-bottom: 20px; margin-top: 0; text-transform: uppercase; letter-spacing: 1px;}
        label { display: block; margin-bottom: 8px; font-weight: bold; margin-top: 15px;}
        
        input, select {
            width: 100%;
            padding: 12px;
            background-color: #141414;
            border: 1px solid #444;
            color: white;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        button.calc-btn {
            width: 100%;
            padding: 15px;
            background-color: var(--btn-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 25px;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.2s;
        }
        button.calc-btn:hover { background-color: var(--btn-hover); }
        
        .result-box {
            margin-top: 25px;
            padding: 20px;
            background-color: #141414;
            border-left: 5px solid var(--accent-color);
            display: none;
        }
        
        .item-image {
            display: block;
            margin: 0 auto 15px auto;
            max-width: 100px;
            height: auto;
        }

        .big-number { font-size: 1.5em; color: var(--accent-color); font-weight: bold; text-align: center; }
        .section-title { color: #888; text-transform: uppercase; font-size: 0.85em; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px;}
        
        ul { list-style-type: none; padding: 0; }
        ul li { background: #222; margin-bottom: 5px; padding: 8px; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;}
        .val { color: #fff; font-weight: bold; }
        
        .instruction {
            background-color: #2a2a35;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #444;
            line-height: 1.6;
        }
        .instruction span { color: #6db3f2; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-buttons">
        <button class="flag-btn active" onclick="setLang('en')" id="btn-en" title="English">ðŸ‡ºðŸ‡¸</button>
        <button class="flag-btn" onclick="setLang('cs')" id="btn-cs" title="ÄŒeÅ¡tina">ðŸ‡¨ðŸ‡¿</button>
        <button class="flag-btn" onclick="setLang('ru')" id="btn-ru" title="Ð ÑƒÑÑÐºÐ¸Ð¹">ðŸ‡·ðŸ‡º</button>
        <button class="flag-btn" onclick="setLang('zh')" id="btn-zh" title="ä¸­æ–‡">ðŸ‡¨ðŸ‡³</button>
    </div>

    <h1>Rust Crafting Master</h1>
    
    <label for="itemType" id="t_selectItem">Select Item</label>
    <select id="itemType">
        </select>

    <label for="sulfur" id="t_enterSulfur">Sulfur Amount</label>
    <input type="number" id="sulfur" placeholder="50000">

    <button onclick="calculate()" id="t_calculateBtn" class="calc-btn">Calculate</button>

    <div id="result" class="result-box">
        <img id="resultImage" src="" alt="Item" class="item-image">
        
        <div style="text-align: center; margin-bottom: 20px;">
            <div id="t_youCanCraft">You can craft:</div>
            <div id="finalCount" class="big-number">0</div>
            <div id="itemNameDisplay" style="color:#aaa;"></div>
        </div>

        <div class="section-title" id="t_sulfurManagement">1. Sulfur Management</div>
        <div class="instruction">
            <span id="t_step1">Take</span> <span id="sulfurToGP">0</span> <span id="t_sulfurRaw">Sulfur</span>.<br>
            <span id="t_step2">Craft it into</span> <span id="gpCount">0</span> <span id="t_gp">Gunpowder</span>.
        </div>
        <div class="instruction" id="expInstructionBox">
            <span id="t_step3">Keep</span> <span id="sulfurToKeep">0</span> <span id="t_sulfurRaw2">Sulfur</span> <span id="t_inInventory">raw in inventory</span>.<br>
            <span id="t_step4">Use it to craft</span> <span id="expCount">0</span> <span id="expLabel">Explosives</span>.
        </div>

        <div class="section-title" id="t_otherMaterials">2. Other Materials Needed</div>
        <ul id="materialsList">
            </ul>
    </div>
</div>

<script>
    // --- TRANSLATIONS ---
    const translations = {
        en: {
            selectItem: "What to craft?",
            enterSulfur: "Total Sulfur Amount",
            calculateBtn: "Calculate Crafting",
            youCanCraft: "You can craft:",
            sulfurManagement: "1. Sulfur Management",
            otherMaterials: "2. Other Materials Needed",
            step1: "Take",
            step2: "Craft it into",
            step3: "Keep",
            step4: "Use it to craft", // Or "Use it for"
            sulfurRaw: "Sulfur",
            gp: "Gunpowder",
            explosives: "Explosives",
            inInventory: "raw in inventory",
            leftover: "Leftover Sulfur",
            useForAmmo: "Use it directly in Ammo mixing",
            items: {
                rocket: "Rocket",
                c4: "Timed Explosive Charge",
                hv: "High Velocity Rocket",
                incen: "Incendiary Rocket",
                exp556: "Explosive 5.56 Ammo (Crafts)",
                charcoal: "Charcoal",
                frags: "Metal Fragments",
                fuel: "Low Grade Fuel",
                pipe: "Metal Pipe",
                tech: "Tech Trash",
                cloth: "Cloth"
            }
        },
        cs: {
            selectItem: "Co chceÅ¡ vyrÃ¡bÄ›t?",
            enterSulfur: "MnoÅ¾stvÃ­ sulfuru",
            calculateBtn: "SpoÄÃ­tat",
            youCanCraft: "MÅ¯Å¾eÅ¡ vyrobit:",
            sulfurManagement: "1. ManaÅ¾ment Sulfuru",
            otherMaterials: "2. DalÅ¡Ã­ suroviny",
            step1: "Vezmi",
            step2: "Vyrob z toho",
            step3: "Nech si",
            step4: "PouÅ¾ij na vÃ½robu",
            sulfurRaw: "Sulfuru",
            gp: "Gunpowderu",
            explosives: "Explosives",
            inInventory: "v inventÃ¡Å™i",
            leftover: "Zbytek sulfuru",
            useForAmmo: "PouÅ¾ij pÅ™Ã­mo pÅ™i vÃ½robÄ› nÃ¡bojÅ¯",
            items: {
                rocket: "Raketa",
                c4: "C4 (Timed Explosive)",
                hv: "HV Raketa",
                incen: "ZÃ¡palnÃ¡ Raketa (Incendiary)",
                exp556: "ExplozivnÃ­ munice 5.56 (Crafty)",
                charcoal: "Charcoal (UhlÃ­)",
                frags: "Metal Fragments",
                fuel: "Low Grade Fuel",
                pipe: "Metal Pipe",
                tech: "Tech Trash",
                cloth: "Cloth (LÃ¡tka)"
            }
        },
        ru: {
            selectItem: "Ð§Ñ‚Ð¾ ÐºÑ€Ð°Ñ„Ñ‚Ð¸Ð¼?",
            enterSulfur: "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¡ÐµÑ€Ñ‹",
            calculateBtn: "Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ",
            youCanCraft: "ÐœÐ¾Ð¶Ð½Ð¾ ÑÐºÑ€Ð°Ñ„Ñ‚Ð¸Ñ‚ÑŒ:",
            sulfurManagement: "1. Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐµÑ€Ð¾Ð¹",
            otherMaterials: "2. Ð¢Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹",
            step1: "Ð’Ð¾Ð·ÑŒÐ¼Ð¸",
            step2: "Ð¡ÐºÑ€Ð°Ñ„Ñ‚Ð¸",
            step3: "ÐžÑÑ‚Ð°Ð²ÑŒ",
            step4: "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð´Ð»Ñ",
            sulfurRaw: "Ð¡ÐµÑ€Ñ‹",
            gp: "ÐŸÐ¾Ñ€Ð¾Ñ…Ð°",
            explosives: "Ð’Ð·Ñ€Ñ‹Ð²Ñ‡Ð°Ñ‚ÐºÐ¸",
            inInventory: "Ð² Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ðµ",
            leftover: "ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº",
            useForAmmo: "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð´Ð»Ñ ÐºÑ€Ð°Ñ„Ñ‚Ð° Ð¿Ð°Ñ‚Ñ€Ð¾Ð½Ð¾Ð²",
            items: {
                rocket: "Ð Ð°ÐºÐµÑ‚Ð°",
                c4: "C4 (Ð’Ð·Ñ€Ñ‹Ð²Ñ‡Ð°Ñ‚ÐºÐ°)",
                hv: "HV Ð Ð°ÐºÐµÑ‚Ð°",
                incen: "Ð—Ð°Ð¶Ð¸Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ€Ð°ÐºÐµÑ‚Ð°",
                exp556: "Ð Ð°Ð·Ñ€Ñ‹Ð²Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ€Ð¾Ð½Ñ‹ (ÐšÑ€Ð°Ñ„Ñ‚Ñ‹)",
                charcoal: "Ð£Ð³Ð¾Ð»ÑŒ",
                frags: "Ð¤Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð°",
                fuel: "Ð¢Ð¾Ð¿Ð»ÐµÐ²Ð¾ (LGF)",
                pipe: "Ð¢Ñ€ÑƒÐ±Ð°",
                tech: "ÐœÐ¸ÐºÑ€Ð¾ÑÑ…ÐµÐ¼Ñ‹",
                cloth: "Ð¢ÐºÐ°Ð½ÑŒ"
            }
        },
        zh: {
            selectItem: "ä½ æƒ³åˆ¶é€ ä»€ä¹ˆï¼Ÿ",
            enterSulfur: "ç¡«ç£ºæ€»é‡",
            calculateBtn: "è®¡ç®—",
            youCanCraft: "ä½ å¯ä»¥åˆ¶é€ ï¼š",
            sulfurManagement: "1. ç¡«ç£ºåˆ†é…",
            otherMaterials: "2. å…¶ä»–æ‰€éœ€ææ–™",
            step1: "å–å‡º",
            step2: "åˆ¶ä½œæˆ",
            step3: "ä¿ç•™",
            step4: "ç”¨äºŽåˆ¶ä½œ",
            sulfurRaw: "ç¡«ç£º",
            gp: "ç«è¯",
            explosives: "ç‚¸è¯",
            inInventory: "åœ¨èƒŒåŒ…ä¸­",
            leftover: "å‰©ä½™ç¡«ç£º",
            useForAmmo: "ç›´æŽ¥ç”¨äºŽåˆ¶ä½œå¼¹è¯",
            items: {
                rocket: "ç«ç®­",
                c4: "å®šæ—¶ç‚¸è¯",
                hv: "é«˜é€Ÿç«ç®­",
                incen: "ç‡ƒçƒ§ç«ç®­",
                exp556: "çˆ†ç‚¸å¼¹è¯ (ç»„)",
                charcoal: "æœ¨ç‚­",
                frags: "é‡‘å±žç¢Žç‰‡",
                fuel: "ä½Žçº§ç‡ƒæ–™",
                pipe: "é‡‘å±žç®¡",
                tech: "ç§‘æŠ€é›¶ä»¶",
                cloth: "å¸ƒ"
            }
        }
    };

    // --- DATA & LOGIC ---
    // sulfurTotal = celkovÃ¡ cena sulfuru (GP + Raw)
    // gpPerItem = kolik GP se spotÅ™ebuje CELKEM (pÅ™Ã­mo v itemu + skrze explosives)
    // explosivesPerItem = kolik vÃ½buÅ¡nin je tÅ™eba
    // rawSulfurToKeep = kolik sulfuru se nesmÃ­ pÅ™edÄ›lat na GP (pro explosives nebo pÅ™Ã­mo do itemu)
    
    const recipes = {
        rocket: {
            id: "rocket",
            sulfurTotal: 1400,
            gpPerItem: 650, 
            explosivesPerItem: 10,
            rawSulfurToKeep: 100, // 10 explosives * 10
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.basic.png",
            other: [
                {id: "charcoal", amount: 1950},
                {id: "frags", amount: 100},
                {id: "fuel", amount: 30},
                {id: "pipe", amount: 2}
            ]
        },
        incen: {
            id: "incen",
            sulfurTotal: 610, // 250 GP (500) + 1 Exp (50GP=100 + 10raw) = 610
            gpPerItem: 300, // 250 direct + 50 in explosive
            explosivesPerItem: 1,
            rawSulfurToKeep: 10, // 1 explosive * 10
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.fire.png",
            other: [
                {id: "charcoal", amount: 900}, // 300 GP * 3
                {id: "frags", amount: 10}, // 1 exp * 10
                {id: "fuel", amount: 260}, // 250 direct + 10 in exp
                {id: "pipe", amount: 2}
            ]
        },
        c4: {
            id: "c4",
            sulfurTotal: 2200,
            gpPerItem: 1000,
            explosivesPerItem: 20,
            rawSulfurToKeep: 200,
            imgUrl: "https://rustlabs.com/img/items180/explosive.timed.png",
            other: [
                {id: "charcoal", amount: 3000},
                {id: "frags", amount: 200},
                {id: "fuel", amount: 60},
                {id: "tech", amount: 2},
                {id: "cloth", amount: 5}
            ]
        },
        hv: {
            id: "hv",
            sulfurTotal: 200,
            gpPerItem: 100,
            explosivesPerItem: 0,
            rawSulfurToKeep: 0,
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.hv.png",
            other: [
                {id: "charcoal", amount: 300},
                {id: "pipe", amount: 1}
            ]
        },
        exp556: {
            id: "exp556",
            // 1 Craft = 2 bullets
            // Recipe: 10 Sulfur + 20 GP + 10 Frags
            sulfurTotal: 50, // 20 GP (40) + 10 Raw = 50
            gpPerItem: 20,
            explosivesPerItem: 0,
            rawSulfurToKeep: 10, // Tady je to surovÃ½ sulfur pÅ™Ã­mo do munice, ne do explosives!
            imgUrl: "https://rustlabs.com/img/items180/ammo.rifle.explosive.png",
            other: [
                {id: "charcoal", amount: 60},
                {id: "frags", amount: 10}
            ]
        }
    };

    let currentLang = "en";

    function setLang(lang) {
        currentLang = lang;
        // Update active button state
        document.querySelectorAll('.flag-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('btn-' + lang).classList.add('active');
        
        updateTexts();
    }

    function updateTexts() {
        const t = translations[currentLang];

        document.getElementById('t_selectItem').innerText = t.selectItem;
        document.getElementById('t_enterSulfur').innerText = t.enterSulfur;
        document.getElementById('t_calculateBtn').innerText = t.calculateBtn;
        document.getElementById('t_youCanCraft').innerText = t.youCanCraft;
        document.getElementById('t_sulfurManagement').innerText = t.sulfurManagement;
        document.getElementById('t_otherMaterials').innerText = t.otherMaterials;
        
        document.getElementById('t_step1').innerText = t.step1;
        document.getElementById('t_step2').innerText = t.step2;
        document.getElementById('t_step3').innerText = t.step3;
        
        document.getElementById('t_sulfurRaw').innerText = t.sulfurRaw;
        document.getElementById('t_sulfurRaw2').innerText = t.sulfurRaw;
        document.getElementById('t_gp').innerText = t.gp;
        document.getElementById('t_inInventory').innerText = t.inInventory;

        // Populate Select Options (keep selection if possible)
        const select = document.getElementById('itemType');
        const selectedValue = select.value;
        select.innerHTML = ""; // Clear existing
        
        for (const [key, value] of Object.entries(recipes)) {
            const opt = document.createElement('option');
            opt.value = key;
            opt.innerText = t.items[value.id];
            select.appendChild(opt);
        }
        
        if (selectedValue && recipes[selectedValue]) {
            select.value = selectedValue;
        }

        // Re-calculate if result is visible
        if(document.getElementById('result').style.display === 'block') {
            calculate();
        }
    }

    function calculate() {
        const sulfurInput = parseInt(document.getElementById('sulfur').value);
        const type = document.getElementById('itemType').value;
        const recipe = recipes[type];
        const t = translations[currentLang];

        if (isNaN(sulfurInput) || sulfurInput <= 0) {
            return;
        }

        const maxItems = Math.floor(sulfurInput / recipe.sulfurTotal);

        if (maxItems === 0) {
            alert(`Not enough Sulfur!`);
            return;
        }

        const totalGP = maxItems * recipe.gpPerItem;
        const sulfurForGP = totalGP * 2;
        const totalExp = maxItems * recipe.explosivesPerItem;
        const sulfurReserved = maxItems * recipe.rawSulfurToKeep;

        // Image
        document.getElementById('resultImage').src = recipe.imgUrl;

        // Numbers
        let countText = maxItems + " x " + t.items[recipe.id];
        // Special display for ammo (users might want to know total bullets)
        if(recipe.id === 'exp556') {
             countText += ` (${maxItems * 2} bullets)`;
        }
        
        document.getElementById('finalCount').innerText = countText;
        
        const leftover = sulfurInput - (maxItems * recipe.sulfurTotal);
        document.getElementById('itemNameDisplay').innerText = `(${t.leftover}: ${leftover})`;

        document.getElementById('sulfurToGP').innerText = sulfurForGP.toLocaleString();
        document.getElementById('gpCount').innerText = totalGP.toLocaleString();

        // Logic for "Step 2" (Explosives vs Raw Mix)
        const expBox = document.getElementById('expInstructionBox');
        const expLabel = document.getElementById('expLabel');
        const step4Label = document.getElementById('t_step4');

        if (recipe.rawSulfurToKeep > 0) {
            expBox.style.display = 'block';
            document.getElementById('sulfurToKeep').innerText = sulfurReserved.toLocaleString();
            
            if (recipe.explosivesPerItem > 0) {
                // Standard rocket/C4 logic
                step4Label.innerText = t.step4; // "Use it to craft"
                document.getElementById('expCount').innerText = totalExp.toLocaleString();
                expLabel.innerText = " " + t.explosives;
            } else {
                // Explosive ammo logic (no explosives needed, just mixing)
                step4Label.innerText = t.useForAmmo; // "Use it directly..."
                document.getElementById('expCount').innerText = ""; // Hide number
                expLabel.innerText = ""; // Hide label
            }
        } else {
            expBox.style.display = 'none';
        }

        const listEl = document.getElementById('materialsList');
        listEl.innerHTML = "";
        
        recipe.other.forEach(mat => {
            const totalNeeded = mat.amount * maxItems;
            const li = document.createElement('li');
            li.innerHTML = `<span>${t.items[mat.id]}</span> <span class="val">${totalNeeded.toLocaleString()}</span>`;
            listEl.appendChild(li);
        });

        document.getElementById('result').style.display = 'block';
    }

    // Initialize
    updateTexts();
</script>

</body>
</html>
